<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Pro Chord Studio - Profesyonel Akor √úretici & Antrenman</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #0a0a0f;
      --bg-card: #12121a;
      --bg-elevated: #1a1a25;
      --border-subtle: #2a2a3a;
      --border-active: #4a4a6a;
      --text-primary: #f0f0f5;
      --text-secondary: #8888a0;
      --text-muted: #5a5a70;
      --accent-green: #00ff88;
      --accent-green-dim: #00cc6a;
      --accent-blue: #00aaff;
      --accent-purple: #aa55ff;
      --accent-orange: #ff8844;
      --accent-red: #ff4466;
      --accent-yellow: #ffcc00;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Animated Background */
    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: 
        radial-gradient(ellipse at 20% 20%, rgba(0, 255, 136, 0.05) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(0, 170, 255, 0.05) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(170, 85, 255, 0.03) 0%, transparent 60%);
    }

    /* Header */
    .header {
      padding: 20px 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border-subtle);
      background: rgba(10, 10, 15, 0.8);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 42px;
      height: 42px;
      background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .logo-text {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .mode-tabs {
      display: flex;
      gap: 4px;
      background: var(--bg-card);
      padding: 4px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
    }

    .mode-tab {
      padding: 10px 20px;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-family: inherit;
      font-size: 0.9rem;
      font-weight: 500;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .mode-tab:hover {
      color: var(--text-primary);
      background: var(--bg-elevated);
    }

    .mode-tab.active {
      background: var(--accent-green);
      color: var(--bg-dark);
    }

    /* Main Container */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px;
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 24px;
    }

    /* Sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .panel {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 20px;
      transition: border-color 0.2s ease;
    }

    .panel:hover {
      border-color: var(--border-active);
    }

    .panel-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
    }

    .panel-icon {
      width: 32px;
      height: 32px;
      background: var(--bg-elevated);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .panel-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    /* Form Controls */
    .control-group {
      margin-bottom: 14px;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    .control-label {
      display: block;
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 6px;
      font-weight: 500;
    }

    select, input[type="number"] {
      width: 100%;
      padding: 10px 14px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
      appearance: none;
    }

    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238888a0' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }

    select:hover, input[type="number"]:hover {
      border-color: var(--border-active);
    }

    select:focus, input[type="number"]:focus {
      outline: none;
      border-color: var(--accent-green);
      box-shadow: 0 0 0 3px var(--glow-green);
    }

    /* Range Slider */
    .slider-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .slider-value {
      min-width: 60px;
      padding: 6px 10px;
      background: var(--bg-elevated);
      border-radius: 6px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      text-align: center;
      color: var(--accent-green);
    }

    input[type="range"] {
      flex: 1;
      height: 6px;
      background: var(--bg-elevated);
      border-radius: 3px;
      appearance: none;
      cursor: pointer;
    }

    input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 18px;
      height: 18px;
      background: var(--accent-green);
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.1s ease;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.15);
    }

    /* Buttons */
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));
      color: var(--bg-dark);
      box-shadow: 0 4px 20px var(--glow-green);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px var(--glow-green);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: var(--bg-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border-subtle);
    }

    .btn-secondary:hover {
      background: var(--border-subtle);
      border-color: var(--border-active);
    }

    .btn-icon {
      width: 44px;
      height: 44px;
      padding: 0;
      border-radius: 12px;
      font-size: 1.2rem;
    }

    .btn-group {
      display: flex;
      gap: 8px;
    }

    .btn-full {
      width: 100%;
    }

    /* Toggle Button */
    .toggle-btn {
      position: relative;
      width: 52px;
      height: 28px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .toggle-btn::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      background: var(--text-secondary);
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .toggle-btn.active {
      background: var(--accent-green);
      border-color: var(--accent-green);
    }

    .toggle-btn.active::after {
      left: 27px;
      background: var(--bg-dark);
    }

    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
    }

    .toggle-label {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* Main Content Area */
    .content-area {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* Transport Controls */
    .transport-bar {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 16px 24px;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .transport-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .transport-btn {
      width: 48px;
      height: 48px;
      border: none;
      border-radius: 50%;
      background: var(--bg-elevated);
      color: var(--text-primary);
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.15s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .transport-btn:hover {
      background: var(--border-subtle);
      transform: scale(1.05);
    }

    .transport-btn.play-btn {
      width: 56px;
      height: 56px;
      background: var(--accent-green);
      color: var(--bg-dark);
    }

    .transport-btn.play-btn:hover {
      box-shadow: 0 0 25px var(--glow-green);
    }

    .transport-btn.play-btn.playing {
      background: var(--accent-orange);
    }

    .transport-btn.active {
      background: var(--accent-blue);
      color: var(--bg-dark);
    }

    .tempo-display {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 20px;
      border-left: 1px solid var(--border-subtle);
      border-right: 1px solid var(--border-subtle);
    }

    .tempo-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--accent-green);
      line-height: 1;
    }

    .tempo-label {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .tempo-controls {
      display: flex;
      gap: 4px;
      margin-top: 6px;
    }

    .tempo-btn {
      width: 28px;
      height: 24px;
      border: none;
      border-radius: 6px;
      background: var(--bg-elevated);
      color: var(--text-secondary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.1s ease;
    }

    .tempo-btn:hover {
      background: var(--border-subtle);
      color: var(--text-primary);
    }

    /* Metronome */
    .metronome-section {
      display: flex;
      align-items: center;
      gap: 16px;
      padding-left: 20px;
      border-left: 1px solid var(--border-subtle);
    }

    .metronome-visual {
      display: flex;
      gap: 6px;
    }

    .beat-dot {
      width: 14px;
      height: 14px;
      background: var(--bg-elevated);
      border: 2px solid var(--border-subtle);
      border-radius: 50%;
      transition: all 0.1s ease;
    }

    .beat-dot.active {
      background: var(--accent-green);
      border-color: var(--accent-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .beat-dot.accent {
      background: var(--accent-orange);
      border-color: var(--accent-orange);
      box-shadow: 0 0 10px rgba(255, 136, 68, 0.5);
    }

    /* Time Signature */
    .time-sig {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: 'JetBrains Mono', monospace;
      font-weight: 700;
      line-height: 1;
    }

    .time-sig-top, .time-sig-bottom {
      font-size: 1.1rem;
    }

    /* Progress */
    .progress-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .progress-bar {
      height: 8px;
      background: var(--bg-elevated);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
      border-radius: 4px;
      width: 0%;
      transition: width 0.1s linear;
    }

    /* Chord Display Area */
    .chord-display {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 24px;
    }

    .chord-display-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .chord-display-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .chord-info-tags {
      display: flex;
      gap: 8px;
    }

    .info-tag {
      padding: 4px 12px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 20px;
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .info-tag span {
      color: var(--accent-green);
      font-weight: 600;
    }

    /* Chord Chips Grid */
    .chords-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .chord-chip {
      position: relative;
      padding: 14px 20px;
      background: var(--bg-elevated);
      border: 2px solid var(--border-subtle);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.15s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 80px;
    }

    .chord-chip:hover {
      border-color: var(--border-active);
      transform: translateY(-2px);
    }

    .chord-chip.active {
      border-color: var(--accent-green);
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 20px var(--glow-green);
    }

    .chord-chip.playing {
      border-color: var(--accent-orange);
      background: rgba(255, 136, 68, 0.15);
      animation: pulse 0.3s ease;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .chord-index {
      position: absolute;
      top: -8px;
      left: -8px;
      width: 22px;
      height: 22px;
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 50%;
      font-size: 0.7rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
    }

    .chord-name {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
    }

    .chord-roman {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .chord-notes-mini {
      font-size: 0.65rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* Roman Numerals Line */
    .roman-line {
      padding: 12px 16px;
      background: var(--bg-elevated);
      border-radius: 10px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-secondary);
      text-align: center;
      letter-spacing: 2px;
    }

    /* Piano Section */
    .piano-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 24px;
    }

    .piano-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .piano-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .current-chord-display {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .current-chord-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-green);
    }

    .current-chord-notes {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* SVG Piano */
    .piano-wrapper {
      background: linear-gradient(180deg, #1a1a25 0%, #0f0f18 100%);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid var(--border-subtle);
    }

    .piano-svg {
      width: 100%;
      max-width: 100%;
      display: block;
    }

    .piano-key {
      transition: fill 0.08s ease, filter 0.08s ease;
      cursor: pointer;
    }

    .white-key {
      fill: linear-gradient(180deg, #ffffff 0%, #e8e8e8 100%);
      fill: #f8f8f8;
      stroke: #d0d0d0;
      stroke-width: 1;
    }

    .white-key:hover {
      fill: #e8e8e8;
    }

    .black-key {
      fill: #1a1a1a;
      stroke: #000;
      stroke-width: 1;
    }

    .black-key:hover {
      fill: #2a2a2a;
    }

    .piano-key.active.white-key {
      fill: #a8ffd0;
      stroke: var(--accent-green);
      stroke-width: 2;
      filter: drop-shadow(0 0 8px var(--glow-green));
    }

    .piano-key.active.black-key {
      fill: var(--accent-green);
      stroke: var(--accent-green);
      filter: drop-shadow(0 0 8px var(--glow-green));
    }

    /* Staff Notation */
    .staff-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 24px;
    }

    .staff-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .staff-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .staff-wrapper {
      background: #fffff8;
      border-radius: 10px;
      padding: 20px;
      overflow-x: auto;
    }

    .staff-svg {
      display: block;
      min-width: 600px;
    }

    /* Articulation Selector */
    .articulation-panel {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }

    .articulation-btn {
      padding: 10px 8px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      color: var(--text-secondary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.15s ease;
      text-align: center;
    }

    .articulation-btn:hover {
      border-color: var(--border-active);
      color: var(--text-primary);
    }

    .articulation-btn.active {
      background: var(--accent-purple);
      border-color: var(--accent-purple);
      color: white;
    }

    .articulation-icon {
      font-size: 1.2rem;
      display: block;
      margin-bottom: 4px;
    }

    /* Training Mode */
    .training-panel {
      background: linear-gradient(135deg, rgba(170, 85, 255, 0.1), rgba(0, 170, 255, 0.1));
      border: 1px solid var(--accent-purple);
    }

    .training-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 16px;
    }

    .stat-box {
      background: var(--bg-elevated);
      border-radius: 10px;
      padding: 12px;
      text-align: center;
    }

    .stat-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-green);
    }

    .stat-label {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Quiz Mode */
    .quiz-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 16px;
    }

    .quiz-option {
      padding: 16px;
      background: var(--bg-elevated);
      border: 2px solid var(--border-subtle);
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.15s ease;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .quiz-option:hover {
      border-color: var(--accent-blue);
      background: rgba(0, 170, 255, 0.1);
    }

    .quiz-option.correct {
      border-color: var(--accent-green);
      background: rgba(0, 255, 136, 0.2);
    }

    .quiz-option.wrong {
      border-color: var(--accent-red);
      background: rgba(255, 68, 102, 0.2);
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .main-container {
        grid-template-columns: 280px 1fr;
      }
    }

    @media (max-width: 900px) {
      .main-container {
        grid-template-columns: 1fr;
      }
      
      .sidebar {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
      }
      
      .transport-bar {
        flex-wrap: wrap;
      }
    }

    @media (max-width: 600px) {
      .header {
        flex-direction: column;
        gap: 12px;
        padding: 16px;
      }
      
      .sidebar {
        grid-template-columns: 1fr;
      }
      
      .main-container {
        padding: 12px;
      }
      
      .transport-bar {
        padding: 12px;
      }
      
      .metronome-section {
        width: 100%;
        justify-content: center;
        padding: 12px 0;
        border-left: none;
        border-top: 1px solid var(--border-subtle);
      }
    }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
    }

    .empty-state-icon {
      font-size: 3rem;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    /* Loading animation */
    .loading-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-subtle);
      border-top-color: var(--accent-green);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Chord Quality Colors */
    .chord-chip[data-quality="maj"] { border-left: 4px solid var(--accent-green); }
    .chord-chip[data-quality="min"] { border-left: 4px solid var(--accent-blue); }
    .chord-chip[data-quality="dim"] { border-left: 4px solid var(--accent-purple); }
    .chord-chip[data-quality="aug"] { border-left: 4px solid var(--accent-orange); }
    .chord-chip[data-quality="dom7"] { border-left: 4px solid var(--accent-yellow); }

    /* Preset chips */
    .preset-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .preset-chip {
      padding: 6px 12px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: 20px;
      font-size: 0.75rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .preset-chip:hover {
      border-color: var(--accent-green);
      color: var(--accent-green);
    }

    /* Volume control */
    .volume-section {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .volume-icon {
      font-size: 1.2rem;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .volume-icon:hover {
      color: var(--text-primary);
    }
  </style>
</head>
<body>
  <div class="bg-animation"></div>
  
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <div class="logo-icon">üéπ</div>
      <div class="logo-text">Pro Chord Studio</div>
    </div>
    
    <div class="mode-tabs">
      <button class="mode-tab active" data-mode="create">Olu≈ütur</button>
      <button class="mode-tab" data-mode="practice">Antrenman</button>
      <button class="mode-tab" data-mode="quiz">Quiz</button>
    </div>
  </header>

  <div class="main-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <!-- Key & Scale Panel -->
      <div class="panel">
        <div class="panel-header">
          <div class="panel-icon">üéµ</div>
          <div class="panel-title">Ton & Gam</div>
        </div>
        
        <div class="control-group">
          <label class="control-label">Ton (Key)</label>
          <select id="keySelect">
            <option value="C">C</option>
            <option value="C#">C# / Db</option>
            <option value="D">D</option>
            <option value="D#">D# / Eb</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="F#">F# / Gb</option>
            <option value="G">G</option>
            <option value="G#">G# / Ab</option>
            <option value="A">A</option>
            <option value="A#">A# / Bb</option>
            <option value="B">B</option>
          </select>
        </div>
        
        <div class="control-group">
          <label class="control-label">Gam / Mod</label>
          <select id="scaleSelect">
            <option value="major">Major (Ionian)</option>
            <option value="naturalMinor">Natural Minor (Aeolian)</option>
            <option value="harmonicMinor">Harmonik Min√∂r</option>
            <option value="melodicMinor">Melodik Min√∂r</option>
            <option value="dorian">Dorian</option>
            <option value="phrygian">Phrygian</option>
            <option value="lydian">Lydian</option>
            <option value="mixolydian">Mixolydian</option>
            <option value="locrian">Locrian</option>
            <option value="pentatonicMajor">Pentatonik Major</option>
            <option value="pentatonicMinor">Pentatonik Minor</option>
            <option value="blues">Blues</option>
          </select>
        </div>
      </div>

      <!-- Style Panel -->
      <div class="panel">
        <div class="panel-header">
          <div class="panel-icon">üé∏</div>
          <div class="panel-title">M√ºzik T√ºr√º</div>
        </div>
        
        <div class="control-group">
          <label class="control-label">T√ºr Se√ßimi</label>
          <select id="styleSelect">
            <option value="pop">Pop</option>
            <option value="rock">Rock</option>
            <option value="ballad">Ballad</option>
            <option value="jazz">Jazz</option>
            <option value="blues">Blues</option>
            <option value="funk">Funk</option>
            <option value="soul">Soul / R&B</option>
            <option value="metal">Metal</option>
            <option value="edm">EDM / Electronic</option>
            <option value="lofi">Lo-Fi</option>
            <option value="latin">Latin</option>
            <option value="classical">Classical</option>
            <option value="gospel">Gospel</option>
            <option value="country">Country</option>
            <option value="reggae">Reggae</option>
            <option value="bossa">Bossa Nova</option>
            <option value="random">Tam Rastgele</option>
          </select>
        </div>
        
        <div class="control-group">
          <label class="control-label">Akor Sayƒ±sƒ±</label>
          <select id="lengthSelect">
            <option value="4">4 Akor</option>
            <option value="8" selected>8 Akor</option>
            <option value="12">12 Akor</option>
            <option value="16">16 Akor</option>
          </select>
        </div>

        <div class="control-group">
          <label class="control-label">Akor T√ºrleri</label>
          <select id="chordTypeSelect">
            <option value="triads">√ú√ßl√ºler (Triads)</option>
            <option value="sevenths">7li Akorlar</option>
            <option value="extended">Geni≈ületilmi≈ü (9, 11, 13)</option>
            <option value="mixed">Karƒ±≈üƒ±k</option>
          </select>
        </div>
      </div>

      <!-- Articulation Panel -->
      <div class="panel">
        <div class="panel-header">
          <div class="panel-icon">üéº</div>
          <div class="panel-title">Artik√ºlasyon</div>
        </div>
        
        <div class="articulation-panel">
          <button class="articulation-btn active" data-articulation="normal">
            <span class="articulation-icon">‚Äî</span>
            Normal
          </button>
          <button class="articulation-btn" data-articulation="staccato">
            <span class="articulation-icon">‚Ä¢</span>
            Staccato
          </button>
          <button class="articulation-btn" data-articulation="legato">
            <span class="articulation-icon">‚åí</span>
            Legato
          </button>
          <button class="articulation-btn" data-articulation="accent">
            <span class="articulation-icon">></span>
            Accent
          </button>
          <button class="articulation-btn" data-articulation="tenuto">
            <span class="articulation-icon">_</span>
            Tenuto
          </button>
          <button class="articulation-btn" data-articulation="marcato">
            <span class="articulation-icon">^</span>
            Marcato
          </button>
          <button class="articulation-btn" data-articulation="sforzando">
            <span class="articulation-icon">sfz</span>
            Sforzando
          </button>
          <button class="articulation-btn" data-articulation="arpeggio">
            <span class="articulation-icon">‚üø</span>
            Arpeggio
          </button>
        </div>
      </div>

      <!-- Sound Settings -->
      <div class="panel">
        <div class="panel-header">
          <div class="panel-icon">üîä</div>
          <div class="panel-title">Ses Ayarlarƒ±</div>
        </div>
        
        <div class="control-group">
          <label class="control-label">Enstr√ºman</label>
          <select id="instrumentSelect">
            <option value="piano">Piyano</option>
            <option value="epiano">Elektrik Piyano</option>
            <option value="organ">Organ</option>
            <option value="strings">Yaylƒ±lar</option>
            <option value="synth">Synth Pad</option>
            <option value="guitar">Gitar</option>
          </select>
        </div>
        
        <div class="control-group">
          <label class="control-label">Oktav</label>
          <select id="octaveSelect">
            <option value="3">3 (D√º≈ü√ºk)</option>
            <option value="4" selected>4 (Orta)</option>
            <option value="5">5 (Y√ºksek)</option>
          </select>
        </div>

        <div class="control-group">
          <label class="control-label">Ses Seviyesi</label>
          <div class="slider-container">
            <input type="range" id="volumeSlider" min="0" max="100" value="70">
            <div class="slider-value" id="volumeValue">70%</div>
          </div>
        </div>

        <div class="toggle-row">
          <span class="toggle-label">Reverb Efekti</span>
          <button class="toggle-btn" id="reverbToggle"></button>
        </div>
      </div>

      <!-- Quick Presets -->
      <div class="panel">
        <div class="panel-header">
          <div class="panel-icon">‚ö°</div>
          <div class="panel-title">Hƒ±zlƒ± Presetler</div>
        </div>
        
        <div class="preset-list">
          <button class="preset-chip" data-preset="pop1">I-V-vi-IV</button>
          <button class="preset-chip" data-preset="jazz1">ii-V-I</button>
          <button class="preset-chip" data-preset="blues1">12-Bar Blues</button>
          <button class="preset-chip" data-preset="rock1">I-IV-V</button>
          <button class="preset-chip" data-preset="sad1">vi-IV-I-V</button>
          <button class="preset-chip" data-preset="epic1">I-VII-vi-V</button>
          <button class="preset-chip" data-preset="jazz2">I-vi-ii-V</button>
          <button class="preset-chip" data-preset="andalusian">Andalusian</button>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="content-area">
      <!-- Transport Bar -->
      <div class="transport-bar">
        <div class="transport-controls">
          <button class="transport-btn" id="stopBtn" title="Durdur">‚èπ</button>
          <button class="transport-btn play-btn" id="playBtn" title="√áal / Duraklat">‚ñ∂</button>
          <button class="transport-btn" id="loopBtn" title="D√∂ng√º">üîÅ</button>
        </div>
        
        <div class="tempo-display">
          <div class="tempo-value" id="tempoDisplay">120</div>
          <div class="tempo-label">BPM</div>
          <div class="tempo-controls">
            <button class="tempo-btn" id="tempoDown">‚àí</button>
            <button class="tempo-btn" id="tempoUp">+</button>
          </div>
        </div>
        
        <div class="metronome-section">
          <button class="transport-btn btn-icon" id="metronomeBtn" title="Metronom">ü•Å</button>
          <div class="time-sig">
            <span class="time-sig-top" id="timeSigTop">4</span>
            <span class="time-sig-bottom" id="timeSigBottom">4</span>
          </div>
          <div class="metronome-visual" id="metronomeVisual">
            <div class="beat-dot"></div>
            <div class="beat-dot"></div>
            <div class="beat-dot"></div>
            <div class="beat-dot"></div>
          </div>
        </div>
        
        <div class="progress-section">
          <div class="progress-info">
            <span id="currentChordNum">Akor 0/0</span>
            <span id="currentTime">0:00</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <div class="volume-section">
          <span class="volume-icon" id="volumeIcon">üîä</span>
        </div>
      </div>

      <!-- Generate Button -->
      <button class="btn btn-primary btn-full" id="generateBtn">
        ‚ú® Yeni Akor Dizisi √úret
      </button>

      <!-- Chord Display -->
      <div class="chord-display">
        <div class="chord-display-header">
          <div class="chord-display-title">Akor Dizisi</div>
          <div class="chord-info-tags">
            <div class="info-tag">Ton: <span id="tagKey">C</span></div>
            <div class="info-tag">Gam: <span id="tagScale">Major</span></div>
            <div class="info-tag">T√ºr: <span id="tagStyle">Pop</span></div>
          </div>
        </div>
        
        <div class="chords-container" id="chordsContainer">
          <div class="empty-state">
            <div class="empty-state-icon">üéπ</div>
            <p>Akor dizisi √ºretmek i√ßin yukarƒ±daki butona tƒ±klayƒ±n</p>
          </div>
        </div>
        
        <div class="roman-line" id="romanLine">
          Roma rakamlarƒ± burada g√∂r√ºnecek
        </div>
      </div>

      <!-- Piano Display -->
      <div class="piano-section">
        <div class="piano-header">
          <div class="piano-title">üéπ Piyano G√∂r√ºn√ºm√º</div>
          <div class="current-chord-display">
            <div class="current-chord-name" id="currentChordName">-</div>
            <div class="current-chord-notes" id="currentChordNotes">Bir akor se√ßin</div>
          </div>
        </div>
        
        <div class="piano-wrapper">
          <svg id="pianoSvg" class="piano-svg" viewBox="0 0 1050 150" preserveAspectRatio="xMidYMid meet">
            <!-- 2 Oktav Piyano - Beyaz Tu≈ülar -->
            <!-- Oktav 1 -->
            <rect class="piano-key white-key" data-note="C" data-octave="4" x="0" y="0" width="75" height="150" rx="0" ry="0"/>
            <rect class="piano-key white-key" data-note="D" data-octave="4" x="75" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="E" data-octave="4" x="150" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="F" data-octave="4" x="225" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="G" data-octave="4" x="300" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="A" data-octave="4" x="375" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="B" data-octave="4" x="450" y="0" width="75" height="150"/>
            <!-- Oktav 2 -->
            <rect class="piano-key white-key" data-note="C" data-octave="5" x="525" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="D" data-octave="5" x="600" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="E" data-octave="5" x="675" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="F" data-octave="5" x="750" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="G" data-octave="5" x="825" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="A" data-octave="5" x="900" y="0" width="75" height="150"/>
            <rect class="piano-key white-key" data-note="B" data-octave="5" x="975" y="0" width="75" height="150"/>
            
            <!-- Siyah Tu≈ülar - Oktav 1 -->
            <rect class="piano-key black-key" data-note="C#" data-octave="4" x="52" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="D#" data-octave="4" x="127" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="F#" data-octave="4" x="277" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="G#" data-octave="4" x="352" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="A#" data-octave="4" x="427" y="0" width="46" height="90" rx="0" ry="4"/>
            <!-- Siyah Tu≈ülar - Oktav 2 -->
            <rect class="piano-key black-key" data-note="C#" data-octave="5" x="577" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="D#" data-octave="5" x="652" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="F#" data-octave="5" x="802" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="G#" data-octave="5" x="877" y="0" width="46" height="90" rx="0" ry="4"/>
            <rect class="piano-key black-key" data-note="A#" data-octave="5" x="952" y="0" width="46" height="90" rx="0" ry="4"/>
            
            <!-- Tu≈ü ƒ∞simleri -->
            <text x="37" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">C4</text>
            <text x="112" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">D</text>
            <text x="187" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">E</text>
            <text x="262" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">F</text>
            <text x="337" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">G</text>
            <text x="412" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">A</text>
            <text x="487" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">B</text>
            <text x="562" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">C5</text>
            <text x="637" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">D</text>
            <text x="712" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">E</text>
            <text x="787" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">F</text>
            <text x="862" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">G</text>
            <text x="937" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">A</text>
            <text x="1012" y="140" text-anchor="middle" font-size="12" fill="#666" font-family="JetBrains Mono">B</text>
          </svg>
        </div>
      </div>

      <!-- Staff Notation -->
      <div class="staff-section">
        <div class="staff-header">
          <div class="staff-title">üìù Nota Yazƒ±mƒ±</div>
        </div>
        
        <div class="staff-wrapper">
          <svg id="staffSvg" class="staff-svg" viewBox="0 0 900 200">
            <!-- Porte √áizgileri -->
            <line x1="50" y1="60" x2="850" y2="60" stroke="#333" stroke-width="1"/>
            <line x1="50" y1="75" x2="850" y2="75" stroke="#333" stroke-width="1"/>
            <line x1="50" y1="90" x2="850" y2="90" stroke="#333" stroke-width="1"/>
            <line x1="50" y1="105" x2="850" y2="105" stroke="#333" stroke-width="1"/>
            <line x1="50" y1="120" x2="850" y2="120" stroke="#333" stroke-width="1"/>
            
            <!-- Sol Anahtarƒ± (Treble Clef) -->
            <text x="60" y="105" font-size="55" fill="#333" font-family="serif">ùÑû</text>
            
            <!-- Notalar burada dinamik olarak eklenecek -->
            <g id="notesGroup"></g>
          </svg>
        </div>
      </div>

      <!-- Training Stats (Hidden by default, shown in practice mode) -->
      <div class="panel training-panel" id="trainingPanel" style="display: none;">
        <div class="panel-header">
          <div class="panel-icon">üìä</div>
          <div class="panel-title">Antrenman ƒ∞statistikleri</div>
        </div>
        
        <div class="training-stats">
          <div class="stat-box">
            <div class="stat-value" id="statCorrect">0</div>
            <div class="stat-label">Doƒüru</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="statTotal">0</div>
            <div class="stat-label">Toplam</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="statAccuracy">0%</div>
            <div class="stat-label">Ba≈üarƒ±</div>
          </div>
        </div>
      </div>

      <!-- Quiz Panel (Hidden by default) -->
      <div class="panel" id="quizPanel" style="display: none;">
        <div class="panel-header">
          <div class="panel-icon">‚ùì</div>
          <div class="panel-title">Bu Hangi Akor?</div>
        </div>
        
        <p style="color: var(--text-secondary); margin-bottom: 16px;">
          √áalan akoru dinleyin ve doƒüru cevabƒ± se√ßin.
        </p>
        
        <button class="btn btn-secondary btn-full" id="playQuizChord">üîä Akoru Tekrar √áal</button>
        
        <div class="quiz-options" id="quizOptions">
          <!-- Quiz se√ßenekleri dinamik olarak eklenecek -->
        </div>
      </div>
    </main>
  </div>

  <script>
    // ============================================
    // B√ñL√úM 1 SONU - B√ñL√úM 2'Yƒ∞ BURAYA YAPI≈ûTIRIN
    // ============================================
// ============================================
    // B√ñL√úM 2 BA≈ûLANGICI
    // ============================================

    // === TEMEL NOTA VE FREKANS TANIMLARI ===
    const NOTES_SHARP = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    const NOTES_FLAT = ["C", "Db", "D", "Eb", "E", "F", "Gb", "G", "Ab", "A", "Bb", "B"];

    // Frekanslar (A4 = 440Hz baz alƒ±narak)
    const BASE_FREQS = {
      "C": 261.63, "C#": 277.18, "Db": 277.18,
      "D": 293.66, "D#": 311.13, "Eb": 311.13,
      "E": 329.63,
      "F": 349.23, "F#": 369.99, "Gb": 369.99,
      "G": 392.00, "G#": 415.30, "Ab": 415.30,
      "A": 440.00, "A#": 466.16, "Bb": 466.16,
      "B": 493.88
    };

    // === GAM KALIPLARI (Yarƒ±m ton aralƒ±klarƒ±) ===
    const SCALE_PATTERNS = {
      major: [0, 2, 4, 5, 7, 9, 11],
      naturalMinor: [0, 2, 3, 5, 7, 8, 10],
      harmonicMinor: [0, 2, 3, 5, 7, 8, 11],
      melodicMinor: [0, 2, 3, 5, 7, 9, 11],
      dorian: [0, 2, 3, 5, 7, 9, 10],
      phrygian: [0, 1, 3, 5, 7, 8, 10],
      lydian: [0, 2, 4, 6, 7, 9, 11],
      mixolydian: [0, 2, 4, 5, 7, 9, 10],
      locrian: [0, 1, 3, 5, 6, 8, 10],
      pentatonicMajor: [0, 2, 4, 7, 9],
      pentatonicMinor: [0, 3, 5, 7, 10],
      blues: [0, 3, 5, 6, 7, 10]
    };

    // === AKOR T√úRLERƒ∞ (Interval yapƒ±larƒ±) ===
    const CHORD_TYPES = {
      // √ú√ßl√ºler (Triads)
      maj: { intervals: [0, 4, 7], symbol: "", name: "Major" },
      min: { intervals: [0, 3, 7], symbol: "m", name: "Minor" },
      dim: { intervals: [0, 3, 6], symbol: "¬∞", name: "Diminished" },
      aug: { intervals: [0, 4, 8], symbol: "+", name: "Augmented" },
      sus2: { intervals: [0, 2, 7], symbol: "sus2", name: "Suspended 2" },
      sus4: { intervals: [0, 5, 7], symbol: "sus4", name: "Suspended 4" },
      
      // 7li Akorlar
      maj7: { intervals: [0, 4, 7, 11], symbol: "maj7", name: "Major 7th" },
      min7: { intervals: [0, 3, 7, 10], symbol: "m7", name: "Minor 7th" },
      dom7: { intervals: [0, 4, 7, 10], symbol: "7", name: "Dominant 7th" },
      dim7: { intervals: [0, 3, 6, 9], symbol: "¬∞7", name: "Diminished 7th" },
      hdim7: { intervals: [0, 3, 6, 10], symbol: "√∏7", name: "Half-Diminished 7th" },
      minMaj7: { intervals: [0, 3, 7, 11], symbol: "m(maj7)", name: "Minor-Major 7th" },
      aug7: { intervals: [0, 4, 8, 10], symbol: "+7", name: "Augmented 7th" },
      
      // Geni≈ületilmi≈ü Akorlar
      maj9: { intervals: [0, 4, 7, 11, 14], symbol: "maj9", name: "Major 9th" },
      min9: { intervals: [0, 3, 7, 10, 14], symbol: "m9", name: "Minor 9th" },
      dom9: { intervals: [0, 4, 7, 10, 14], symbol: "9", name: "Dominant 9th" },
      add9: { intervals: [0, 4, 7, 14], symbol: "add9", name: "Add 9" },
      dom11: { intervals: [0, 4, 7, 10, 14, 17], symbol: "11", name: "Dominant 11th" },
      dom13: { intervals: [0, 4, 7, 10, 14, 21], symbol: "13", name: "Dominant 13th" },
      
      // √ñzel Akorlar
      "6": { intervals: [0, 4, 7, 9], symbol: "6", name: "Major 6th" },
      "m6": { intervals: [0, 3, 7, 9], symbol: "m6", name: "Minor 6th" },
      "7sus4": { intervals: [0, 5, 7, 10], symbol: "7sus4", name: "7th Suspended 4" },
      "7#9": { intervals: [0, 4, 7, 10, 15], symbol: "7#9", name: "7th Sharp 9 (Hendrix)" },
      "7b9": { intervals: [0, 4, 7, 10, 13], symbol: "7b9", name: "7th Flat 9" }
    };

    // === M√úZƒ∞K T√úR√ú AKOR Dƒ∞Zƒ∞Lƒ∞MLERƒ∞ ===
    const PROGRESSION_PATTERNS = {
      pop: [
        { degrees: [1, 5, 6, 4], name: "Klasik Pop (Axis)" },
        { degrees: [6, 4, 1, 5], name: "Sad Pop" },
        { degrees: [1, 6, 4, 5], name: "50s Progression" },
        { degrees: [1, 4, 5, 4], name: "Simple Pop" },
        { degrees: [1, 5, 4, 5], name: "Uplifting Pop" },
        { degrees: [1, 4, 6, 5], name: "Modern Pop" }
      ],
      rock: [
        { degrees: [1, 4, 5, 4], name: "Classic Rock" },
        { degrees: [1, 5, 4, 5], name: "Power Rock" },
        { degrees: [1, 7, 4, 4], name: "Hard Rock" },
        { degrees: [1, 3, 4, 5], name: "Blues Rock" },
        { degrees: [1, 6, 3, 7], name: "Epic Rock" }
      ],
      ballad: [
        { degrees: [1, 6, 2, 5], name: "Classic Ballad" },
        { degrees: [1, 4, 2, 5], name: "Soft Ballad" },
        { degrees: [1, 3, 6, 4], name: "Emotional Ballad" },
        { degrees: [6, 4, 1, 5], name: "Sad Ballad" },
        { degrees: [1, 5, 6, 3, 4, 1, 4, 5], name: "Canon Ballad" }
      ],
      jazz: [
        { degrees: [2, 5, 1], name: "ii-V-I" },
        { degrees: [2, 5, 1, 6], name: "ii-V-I-vi (Turnaround)" },
        { degrees: [1, 6, 2, 5], name: "I-vi-ii-V (Rhythm Changes)" },
        { degrees: [3, 6, 2, 5], name: "iii-VI-ii-V" },
        { degrees: [1, 4, 3, 6, 2, 5, 1], name: "Extended Jazz" },
        { degrees: [4, 7, 3, 6, 2, 5, 1], name: "Coltrane Changes" }
      ],
      blues: [
        { degrees: [1, 1, 1, 1, 4, 4, 1, 1, 5, 4, 1, 5], name: "12-Bar Blues" },
        { degrees: [1, 4, 1, 5], name: "Simple Blues" },
        { degrees: [1, 4, 1, 1, 4, 4, 1, 1, 5, 5, 1, 1], name: "Slow Blues" }
      ],
      funk: [
        { degrees: [1, 1, 4, 4], name: "Funky Groove" },
        { degrees: [1, 4, 1, 5], name: "Classic Funk" },
        { degrees: [2, 5, 1, 1], name: "Jazz Funk" },
        { degrees: [1, 7, 4, 4], name: "Chromatic Funk" }
      ],
      soul: [
        { degrees: [1, 4, 1, 5], name: "Classic Soul" },
        { degrees: [1, 6, 4, 5], name: "Motown" },
        { degrees: [2, 5, 1, 4], name: "Smooth Soul" },
        { degrees: [1, 3, 4, 4], name: "Gospel Soul" }
      ],
      metal: [
        { degrees: [1, 6, 7, 1], name: "Power Metal" },
        { degrees: [1, 7, 6, 5], name: "Descending Metal" },
        { degrees: [1, 2, 1, 7], name: "Phrygian Metal" },
        { degrees: [1, 5, 6, 4], name: "Melodic Metal" }
      ],
      edm: [
        { degrees: [1, 5, 6, 4], name: "EDM Anthem" },
        { degrees: [6, 4, 1, 5], name: "Emotional EDM" },
        { degrees: [1, 6, 4, 5], name: "Progressive House" },
        { degrees: [6, 7, 1, 1], name: "Trance" }
      ],
      lofi: [
        { degrees: [2, 5, 1, 6], name: "Jazzy Lo-Fi" },
        { degrees: [1, 6, 2, 5], name: "Chill Lo-Fi" },
        { degrees: [4, 5, 3, 6], name: "Dreamy Lo-Fi" },
        { degrees: [1, 4, 6, 5], name: "Nostalgic Lo-Fi" }
      ],
      latin: [
        { degrees: [1, 4, 5, 5], name: "Latin Basic" },
        { degrees: [2, 5, 1, 1], name: "Salsa" },
        { degrees: [1, 4, 5, 4], name: "Bossa Nova" },
        { degrees: [6, 7, 1, 1], name: "Spanish" }
      ],
      classical: [
        { degrees: [1, 4, 5, 1], name: "Classical Cadence" },
        { degrees: [1, 5, 6, 3, 4, 1, 4, 5], name: "Pachelbel Canon" },
        { degrees: [1, 6, 4, 5], name: "Romantic" },
        { degrees: [1, 4, 1, 5, 1], name: "Baroque" }
      ],
      gospel: [
        { degrees: [1, 4, 1, 5], name: "Traditional Gospel" },
        { degrees: [1, 1, 4, 4, 1, 5, 1], name: "Gospel Hymn" },
        { degrees: [4, 4, 1, 1, 5, 5, 1], name: "Soulful Gospel" },
        { degrees: [1, 3, 4, 5], name: "Contemporary Gospel" }
      ],
      country: [
        { degrees: [1, 4, 5, 1], name: "Classic Country" },
        { degrees: [1, 5, 1, 4], name: "Country Waltz" },
        { degrees: [1, 4, 1, 5, 4, 1], name: "Nashville" }
      ],
      reggae: [
        { degrees: [1, 5, 6, 4], name: "Roots Reggae" },
        { degrees: [1, 4, 1, 5], name: "One Drop" },
        { degrees: [6, 5, 4, 5], name: "Dub" }
      ],
      bossa: [
        { degrees: [1, 2, 5, 1], name: "Bossa Basic" },
        { degrees: [1, 6, 2, 5], name: "Girl from Ipanema" },
        { degrees: [1, 4, 3, 6, 2, 5, 1], name: "Advanced Bossa" }
      ]
    };

    // === PRESET AKOR Dƒ∞Zƒ∞Lƒ∞MLERƒ∞ ===
    const PRESETS = {
      pop1: { key: "C", scale: "major", degrees: [1, 5, 6, 4], name: "I-V-vi-IV" },
      jazz1: { key: "C", scale: "major", degrees: [2, 5, 1], name: "ii-V-I", chordType: "sevenths" },
      blues1: { key: "A", scale: "blues", degrees: [1, 1, 1, 1, 4, 4, 1, 1, 5, 4, 1, 5], name: "12-Bar Blues" },
      rock1: { key: "G", scale: "major", degrees: [1, 4, 5], name: "I-IV-V" },
      sad1: { key: "A", scale: "naturalMinor", degrees: [6, 4, 1, 5], name: "vi-IV-I-V" },
      epic1: { key: "C", scale: "major", degrees: [1, 7, 6, 5], name: "Epic" },
      jazz2: { key: "F", scale: "major", degrees: [1, 6, 2, 5], name: "Rhythm Changes", chordType: "sevenths" },
      andalusian: { key: "A", scale: "phrygian", degrees: [1, 7, 6, 5], name: "Andalusian Cadence" }
    };

    // === GLOBAL DURUM DEƒûƒ∞≈ûKENLERƒ∞ ===
    let currentChords = [];
    let currentChordIndex = -1;
    let isPlaying = false;
    let isLooping = false;
    let tempo = 120;
    let metronomeOn = false;
    let currentArticulation = "normal";
    let currentMode = "create"; // create, practice, quiz
    let volume = 0.7;
    let reverbEnabled = false;
    let currentOctave = 4;
    let currentInstrument = "piano";
    let playbackInterval = null;
    let metronomeInterval = null;
    let currentBeat = 0;
    let beatsPerMeasure = 4;

    // Quiz deƒüi≈ükenleri
    let quizCorrectAnswer = null;
    let quizStats = { correct: 0, total: 0 };

    // === WEB AUDIO API KURULUMU ===
    let audioCtx = null;
    let masterGain = null;
    let reverbNode = null;

    function initAudio() {
      if (audioCtx) return;
      
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      
      // Master Gain
      masterGain = audioCtx.createGain();
      masterGain.gain.value = volume;
      
      // Reverb (Convolver sim√ºlasyonu - basit delay ile)
      reverbNode = audioCtx.createGain();
      reverbNode.gain.value = 0;
      
      masterGain.connect(audioCtx.destination);
    }

    function resumeAudio() {
      if (audioCtx && audioCtx.state === "suspended") {
        audioCtx.resume();
      }
    }

    // === SES √úRETƒ∞Mƒ∞ FONKSƒ∞YONLARI ===

    // Enstr√ºman dalga formlarƒ±
    const INSTRUMENT_WAVES = {
      piano: "triangle",
      epiano: "sine",
      organ: "square",
      strings: "sawtooth",
      synth: "sine",
      guitar: "triangle"
    };

    // Enstr√ºman ADSR zarflarƒ± (Attack, Decay, Sustain, Release)
    const INSTRUMENT_ENVELOPES = {
      piano: { attack: 0.01, decay: 0.3, sustain: 0.4, release: 0.5 },
      epiano: { attack: 0.02, decay: 0.2, sustain: 0.5, release: 0.4 },
      organ: { attack: 0.05, decay: 0.1, sustain: 0.8, release: 0.2 },
      strings: { attack: 0.15, decay: 0.2, sustain: 0.7, release: 0.8 },
      synth: { attack: 0.1, decay: 0.3, sustain: 0.6, release: 0.5 },
      guitar: { attack: 0.005, decay: 0.4, sustain: 0.2, release: 0.3 }
    };

    // Artik√ºlasyon parametreleri
    const ARTICULATION_PARAMS = {
      normal: { durationMult: 1.0, velocityMult: 1.0, attackMult: 1.0 },
      staccato: { durationMult: 0.3, velocityMult: 1.1, attackMult: 0.8 },
      legato: { durationMult: 1.2, velocityMult: 0.9, attackMult: 1.5 },
      accent: { durationMult: 0.9, velocityMult: 1.4, attackMult: 0.7 },
      tenuto: { durationMult: 1.1, velocityMult: 1.0, attackMult: 1.2 },
      marcato: { durationMult: 0.8, velocityMult: 1.5, attackMult: 0.5 },
      sforzando: { durationMult: 0.7, velocityMult: 1.8, attackMult: 0.3 },
      arpeggio: { durationMult: 1.0, velocityMult: 1.0, attackMult: 1.0, isArpeggio: true }
    };

    // Nota frekansƒ± hesaplama (oktav dahil)
    function getNoteFrequency(noteName, octave = 4) {
      const baseFreq = BASE_FREQS[noteName];
      if (!baseFreq) return 440;
      
      // Oktav 4 baz alƒ±narak hesapla
      const octaveDiff = octave - 4;
      return baseFreq * Math.pow(2, octaveDiff);
    }

    // Tek nota √ßalma
    function playNote(frequency, duration = 0.5, delay = 0, velocityMult = 1.0) {
      if (!audioCtx) initAudio();
      resumeAudio();

      const envelope = INSTRUMENT_ENVELOPES[currentInstrument];
      const artParams = ARTICULATION_PARAMS[currentArticulation];
      
      const actualDuration = duration * artParams.durationMult;
      const actualVelocity = volume * velocityMult * artParams.velocityMult;
      const actualAttack = envelope.attack * artParams.attackMult;

      const startTime = audioCtx.currentTime + delay;

      // Oscillator
      const osc = audioCtx.createOscillator();
      osc.type = INSTRUMENT_WAVES[currentInstrument];
      osc.frequency.setValueAtTime(frequency, startTime);

      // Gain (ADSR zarf)
      const gainNode = audioCtx.createGain();
      gainNode.gain.setValueAtTime(0, startTime);
      
      // Attack
      gainNode.gain.linearRampToValueAtTime(actualVelocity * 0.5, startTime + actualAttack);
      
      // Decay -> Sustain
      gainNode.gain.linearRampToValueAtTime(
        actualVelocity * 0.5 * envelope.sustain,
        startTime + actualAttack + envelope.decay
      );
      
      // Release
      const releaseStart = startTime + actualDuration - envelope.release;
      gainNode.gain.setValueAtTime(actualVelocity * 0.5 * envelope.sustain, releaseStart);
      gainNode.gain.exponentialRampToValueAtTime(0.001, startTime + actualDuration);

      // Baƒülantƒ±lar
      osc.connect(gainNode);
      gainNode.connect(masterGain);

      osc.start(startTime);
      osc.stop(startTime + actualDuration + 0.1);
    }

    // Akor √ßalma
    function playChord(chordName, duration = 0.8) {
      if (!audioCtx) initAudio();
      resumeAudio();

      const notes = getChordNotes(chordName);
      const artParams = ARTICULATION_PARAMS[currentArticulation];

      if (artParams.isArpeggio) {
        // Arpeggio: notalarƒ± sƒ±rayla √ßal
        const noteDelay = 0.08;
        notes.forEach((freq, index) => {
          playNote(freq, duration, index * noteDelay);
        });
      } else {
        // Normal: t√ºm notalarƒ± aynƒ± anda √ßal
        notes.forEach(freq => {
          playNote(freq, duration);
        });
      }
    }

    // Akor notalarƒ±nƒ± frekans olarak al
    function getChordNotes(chordName) {
      const parsed = parseChordName(chordName);
      if (!parsed) return [];

      const { root, type } = parsed;
      const chordDef = CHORD_TYPES[type];
      if (!chordDef) return [];

      const rootIndex = NOTES_SHARP.indexOf(root) !== -1 
        ? NOTES_SHARP.indexOf(root) 
        : NOTES_FLAT.indexOf(root);
      
      if (rootIndex === -1) return [];

      return chordDef.intervals.map(interval => {
        const noteIndex = (rootIndex + interval) % 12;
        const octaveAdd = Math.floor((rootIndex + interval) / 12);
        const noteName = NOTES_SHARP[noteIndex];
        return getNoteFrequency(noteName, currentOctave + octaveAdd);
      });
    }

    // Akor notalarƒ±nƒ± isim olarak al
    function getChordNoteNames(chordName) {
      const parsed = parseChordName(chordName);
      if (!parsed) return [];

      const { root, type } = parsed;
      const chordDef = CHORD_TYPES[type];
      if (!chordDef) return [];

      const rootIndex = NOTES_SHARP.indexOf(root) !== -1 
        ? NOTES_SHARP.indexOf(root) 
        : NOTES_FLAT.indexOf(root);
      
      if (rootIndex === -1) return [];

      return chordDef.intervals.map(interval => {
        const noteIndex = (rootIndex + interval) % 12;
        return NOTES_SHARP[noteIndex];
      });
    }

    // Akor adƒ±nƒ± parse et
    function parseChordName(chordName) {
      if (!chordName) return null;

      // Root notayƒ± bul (ilk 1 veya 2 karakter)
      let root = chordName[0];
      let suffix = chordName.slice(1);

      if (suffix.startsWith("#") || suffix.startsWith("b")) {
        root += suffix[0];
        suffix = suffix.slice(1);
      }

      // Suffix'ten akor tipini belirle
      let type = "maj";

      if (suffix === "" || suffix === "M") {
        type = "maj";
      } else if (suffix === "m" || suffix === "min") {
        type = "min";
      } else if (suffix === "¬∞" || suffix === "dim") {
        type = "dim";
      } else if (suffix === "+" || suffix === "aug") {
        type = "aug";
      } else if (suffix === "7") {
        type = "dom7";
      } else if (suffix === "maj7" || suffix === "M7") {
        type = "maj7";
      } else if (suffix === "m7" || suffix === "min7") {
        type = "min7";
      } else if (suffix === "¬∞7" || suffix === "dim7") {
        type = "dim7";
      } else if (suffix === "√∏7" || suffix === "m7b5") {
        type = "hdim7";
      } else if (suffix === "sus2") {
        type = "sus2";
      } else if (suffix === "sus4") {
        type = "sus4";
      } else if (suffix === "9") {
        type = "dom9";
      } else if (suffix === "maj9") {
        type = "maj9";
      } else if (suffix === "m9") {
        type = "min9";
      } else if (suffix === "add9") {
        type = "add9";
      } else if (suffix === "6") {
        type = "6";
      } else if (suffix === "m6") {
        type = "m6";
      } else if (suffix === "7sus4") {
        type = "7sus4";
      } else if (suffix === "7#9") {
        type = "7#9";
      } else if (suffix === "7b9") {
        type = "7b9";
      } else if (suffix === "11") {
        type = "dom11";
      } else if (suffix === "13") {
        type = "dom13";
      }

      return { root, type, suffix };
    }

    // === GAM VE AKOR OLU≈ûTURMA ===

    // Belirli bir ton ve gamda diyatonik akorlarƒ± olu≈ütur
    function buildScaleChords(key, scaleType, chordTypeOption = "triads") {
      const pattern = SCALE_PATTERNS[scaleType];
      if (!pattern) return [];

      const rootIndex = NOTES_SHARP.indexOf(key);
      if (rootIndex === -1) return [];

      // Gam notalarƒ±nƒ± olu≈ütur
      const scaleNotes = pattern.map(interval => {
        return NOTES_SHARP[(rootIndex + interval) % 12];
      });

      const chords = [];

      // Her derece i√ßin akor olu≈ütur
      for (let degree = 0; degree < scaleNotes.length; degree++) {
        const chordRoot = scaleNotes[degree];
        
        // 3l√º ve 5li intervallerini hesapla (gam i√ßinde)
        const thirdDegree = (degree + 2) % scaleNotes.length;
        const fifthDegree = (degree + 4) % scaleNotes.length;

        const thirdNote = scaleNotes[thirdDegree];
        const fifthNote = scaleNotes[fifthDegree];

        // Yarƒ±m ton cinsinden intervalleri hesapla
        const rootIdx = NOTES_SHARP.indexOf(chordRoot);
        const thirdIdx = NOTES_SHARP.indexOf(thirdNote);
        const fifthIdx = NOTES_SHARP.indexOf(fifthNote);

        const thirdInterval = (thirdIdx - rootIdx + 12) % 12;
        const fifthInterval = (fifthIdx - rootIdx + 12) % 12;

        // Akor kalitesini belirle
        let quality, suffix;

        if (thirdInterval === 4 && fifthInterval === 7) {
          quality = "maj";
          suffix = "";
        } else if (thirdInterval === 3 && fifthInterval === 7) {
          quality = "min";
          suffix = "m";
        } else if (thirdInterval === 3 && fifthInterval === 6) {
          quality = "dim";
          suffix = "¬∞";
        } else if (thirdInterval === 4 && fifthInterval === 8) {
          quality = "aug";
          suffix = "+";
        } else {
          quality = "maj";
          suffix = "";
        }

        // 7li akor istendiyse ekle
        if (chordTypeOption === "sevenths" || chordTypeOption === "extended" || chordTypeOption === "mixed") {
          const seventhDegree = (degree + 6) % scaleNotes.length;
          const seventhNote = scaleNotes[seventhDegree];
          const seventhIdx = NOTES_SHARP.indexOf(seventhNote);
          const seventhInterval = (seventhIdx - rootIdx + 12) % 12;

          if (chordTypeOption === "sevenths" || (chordTypeOption === "mixed" && Math.random() > 0.5)) {
            if (quality === "maj") {
              if (seventhInterval === 11) {
                suffix = "maj7";
                quality = "maj7";
              } else {
                suffix = "7";
                quality = "dom7";
              }
            } else if (quality === "min") {
              suffix = "m7";
              quality = "min7";
            } else if (quality === "dim") {
              suffix = "√∏7";
              quality = "hdim7";
            }
          }
        }

        chords.push({
          degree: degree + 1,
          name: chordRoot + suffix,
          root: chordRoot,
          quality,
          suffix
        });
      }

      return chords;
    }

    // Roma rakamƒ± olu≈ütur
    function romanNumeral(degree, quality) {
      const numerals = ["I", "II", "III", "IV", "V", "VI", "VII"];
      let roman = numerals[degree - 1] || "?";

      // Min√∂r ve diminished k√º√ß√ºk harfle
      if (quality === "min" || quality === "min7" || quality === "dim" || quality === "hdim7") {
        roman = roman.toLowerCase();
      }

      // Ek semboller
      if (quality === "dim" || quality === "dim7") {
        roman += "¬∞";
      } else if (quality === "hdim7") {
        roman += "√∏";
      } else if (quality === "aug") {
        roman += "+";
      }

      // 7li g√∂sterimi
      if (quality.includes("7") || quality.includes("maj7")) {
        if (quality === "maj7") {
          roman += "Œî7";
        } else if (quality === "dom7") {
          roman += "7";
        } else if (quality === "min7") {
          roman += "7";
        } else if (quality === "hdim7") {
          roman += "7";
        }
      }

      return roman;
    }

    // === YARDIMCI FONKSƒ∞YONLAR ===

    function pickRandom(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    function shuffleArray(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // Tempo'dan milisaniye hesapla (bir vuru≈ü)
    function getMillisecondsPerBeat() {
      return 60000 / tempo;
    }

    // Tempo'dan bir akor s√ºresi (genellikle 2 veya 4 vuru≈ü)
    function getChordDuration() {
      return getMillisecondsPerBeat() * 2; // 2 vuru≈ü per akor
    }

    // ============================================
    // B√ñL√úM 2 SONU - B√ñL√úM 3'√ú BURAYA YAPI≈ûTIRIN
    // ============================================
// ============================================
    // B√ñL√úM 3 BA≈ûLANGICI
    // ============================================

    // === AKOR Dƒ∞Zƒ∞Sƒ∞ √úRETME ===

    function generateChordProgression() {
      const key = document.getElementById("keySelect").value;
      const scaleType = document.getElementById("scaleSelect").value;
      const style = document.getElementById("styleSelect").value;
      const length = parseInt(document.getElementById("lengthSelect").value, 10);
      const chordTypeOption = document.getElementById("chordTypeSelect").value;

      // Gam akorlarƒ±nƒ± olu≈ütur
      const scaleChords = buildScaleChords(key, scaleType, chordTypeOption);
      if (!scaleChords.length) {
        alert("Bu ton/gam kombinasyonu i√ßin akorlar olu≈üturulamadƒ±.");
        return;
      }

      let degreeSequence = [];

      if (style === "random") {
        // Tam rastgele
        let lastDegree = null;
        for (let i = 0; i < length; i++) {
          let d;
          do {
            d = Math.floor(Math.random() * scaleChords.length) + 1;
          } while (d === lastDegree && scaleChords.length > 1);
          degreeSequence.push(d);
          lastDegree = d;
        }
      } else {
        // Stil bazlƒ± kalƒ±p se√ß
        const patterns = PROGRESSION_PATTERNS[style];
        if (patterns && patterns.length > 0) {
          const selectedPattern = pickRandom(patterns);
          const patternDegrees = selectedPattern.degrees;

          // Kalƒ±bƒ± uzunluƒüa g√∂re tekrarla
          while (degreeSequence.length < length) {
            degreeSequence = degreeSequence.concat(patternDegrees);
          }
          degreeSequence = degreeSequence.slice(0, length);
        } else {
          // Fallback: basit I-IV-V-I
          degreeSequence = [1, 4, 5, 1];
          while (degreeSequence.length < length) {
            degreeSequence = degreeSequence.concat([1, 4, 5, 1]);
          }
          degreeSequence = degreeSequence.slice(0, length);
        }
      }

      // Derece dizisini akor objelerine √ßevir
      currentChords = degreeSequence.map(degree => {
        // Derece gam uzunluƒüunu a≈üarsa modulo al
        const adjustedDegree = ((degree - 1) % scaleChords.length) + 1;
        const chord = scaleChords[adjustedDegree - 1];
        return {
          ...chord,
          degree: adjustedDegree
        };
      });

      // UI'ƒ± g√ºncelle
      updateChordDisplay();
      updateTags(key, scaleType, style);
      
      // ƒ∞lk akoru g√∂ster
      if (currentChords.length > 0) {
        selectChord(0);
      }

      // Otomatik √ßalmayƒ± ba≈ülat
      stopPlayback();
      startPlayback();
    }

    // === AKOR G√ñSTERME ===

    function updateChordDisplay() {
      const container = document.getElementById("chordsContainer");
      container.innerHTML = "";

      if (currentChords.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üéπ</div>
            <p>Akor dizisi √ºretmek i√ßin butona tƒ±klayƒ±n</p>
          </div>
        `;
        return;
      }

      currentChords.forEach((chord, index) => {
        const chip = document.createElement("div");
        chip.className = "chord-chip";
        chip.dataset.index = index;
        chip.dataset.quality = chord.quality;

        const noteNames = getChordNoteNames(chord.name);

        chip.innerHTML = `
          <span class="chord-index">${index + 1}</span>
          <span class="chord-name">${chord.name}</span>
          <span class="chord-roman">${romanNumeral(chord.degree, chord.quality)}</span>
          <span class="chord-notes-mini">${noteNames.join(" - ")}</span>
        `;

        chip.addEventListener("click", () => {
          selectChord(index);
          playChord(chord.name, 0.8);
        });

        container.appendChild(chip);
      });

      // Roma rakamlarƒ± satƒ±rƒ±nƒ± g√ºncelle
      const romanLine = document.getElementById("romanLine");
      const romanNumerals = currentChords.map(ch => romanNumeral(ch.degree, ch.quality));
      romanLine.textContent = romanNumerals.join("  ‚Äî  ");
    }

    function selectChord(index) {
      // √ñnceki se√ßimi kaldƒ±r
      document.querySelectorAll(".chord-chip").forEach(chip => {
        chip.classList.remove("active");
      });

      // Yeni se√ßimi i≈üaretle
      const chips = document.querySelectorAll(".chord-chip");
      if (chips[index]) {
        chips[index].classList.add("active");
      }

      currentChordIndex = index;

      // Piyano ve nota g√∂sterimini g√ºncelle
      const chord = currentChords[index];
      if (chord) {
        highlightPiano(chord.name);
        updateStaffNotation(chord.name);
        updateCurrentChordInfo(chord.name);
      }
    }

    function highlightPlayingChord(index) {
      document.querySelectorAll(".chord-chip").forEach(chip => {
        chip.classList.remove("playing");
      });

      const chips = document.querySelectorAll(".chord-chip");
      if (chips[index]) {
        chips[index].classList.add("playing");
      }
    }

    function updateTags(key, scaleType, style) {
      document.getElementById("tagKey").textContent = key;

      const scaleNames = {
        major: "Major",
        naturalMinor: "Natural Minor",
        harmonicMinor: "Harmonik Min√∂r",
        melodicMinor: "Melodik Min√∂r",
        dorian: "Dorian",
        phrygian: "Phrygian",
        lydian: "Lydian",
        mixolydian: "Mixolydian",
        locrian: "Locrian",
        pentatonicMajor: "Pentatonik Major",
        pentatonicMinor: "Pentatonik Minor",
        blues: "Blues"
      };
      document.getElementById("tagScale").textContent = scaleNames[scaleType] || scaleType;

      const styleNames = {
        pop: "Pop", rock: "Rock", ballad: "Ballad", jazz: "Jazz",
        blues: "Blues", funk: "Funk", soul: "Soul/R&B", metal: "Metal",
        edm: "EDM", lofi: "Lo-Fi", latin: "Latin", classical: "Classical",
        gospel: "Gospel", country: "Country", reggae: "Reggae", bossa: "Bossa Nova",
        random: "Rastgele"
      };
      document.getElementById("tagStyle").textContent = styleNames[style] || style;
    }

    function updateCurrentChordInfo(chordName) {
      document.getElementById("currentChordName").textContent = chordName;
      const noteNames = getChordNoteNames(chordName);
      document.getElementById("currentChordNotes").textContent = noteNames.join(" - ");
    }

    // === Pƒ∞YANO G√ñSTERƒ∞Mƒ∞ ===

    function highlightPiano(chordName) {
      // T√ºm tu≈ülarƒ± temizle
      document.querySelectorAll(".piano-key").forEach(key => {
        key.classList.remove("active");
      });

      const noteNames = getChordNoteNames(chordName);

      // E≈üle≈üen tu≈ülarƒ± i≈üaretle
      document.querySelectorAll(".piano-key").forEach(key => {
        const keyNote = key.dataset.note;
        if (noteNames.includes(keyNote)) {
          key.classList.add("active");
        }
      });
    }

    function clearPianoHighlight() {
      document.querySelectorAll(".piano-key").forEach(key => {
        key.classList.remove("active");
      });
    }

    // === NOTA YAZIMI (STAFF NOTATION) ===

    function updateStaffNotation(chordName) {
      const notesGroup = document.getElementById("notesGroup");
      notesGroup.innerHTML = "";

      const noteNames = getChordNoteNames(chordName);
      if (noteNames.length === 0) return;

      // Nota pozisyonlarƒ± (treble clef, middle C = ledger line below)
      const notePositions = {
        "C": 125, "D": 117.5, "E": 110, "F": 102.5,
        "G": 95, "A": 87.5, "B": 80,
        "C#": 125, "D#": 117.5, "F#": 102.5, "G#": 95, "A#": 87.5
      };

      // Her nota i√ßin
      noteNames.forEach((note, index) => {
        const xPos = 150 + index * 80;
        const yPos = notePositions[note] || 90;
        const isSharp = note.includes("#");
        const baseNote = note.replace("#", "");

        // Nota kafasƒ± (filled oval)
        const noteHead = document.createElementNS("http://www.w3.org/2000/svg", "ellipse");
        noteHead.setAttribute("cx", xPos);
        noteHead.setAttribute("cy", yPos);
        noteHead.setAttribute("rx", 8);
        noteHead.setAttribute("ry", 6);
        noteHead.setAttribute("fill", "#222");
        noteHead.setAttribute("transform", `rotate(-20, ${xPos}, ${yPos})`);
        notesGroup.appendChild(noteHead);

        // Nota sapƒ± (stem)
        const stem = document.createElementNS("http://www.w3.org/2000/svg", "line");
        if (yPos > 90) {
          // Sap yukarƒ±
          stem.setAttribute("x1", xPos + 7);
          stem.setAttribute("y1", yPos);
          stem.setAttribute("x2", xPos + 7);
          stem.setAttribute("y2", yPos - 35);
        } else {
          // Sap a≈üaƒüƒ±
          stem.setAttribute("x1", xPos - 7);
          stem.setAttribute("y1", yPos);
          stem.setAttribute("x2", xPos - 7);
          stem.setAttribute("y2", yPos + 35);
        }
        stem.setAttribute("stroke", "#222");
        stem.setAttribute("stroke-width", "1.5");
        notesGroup.appendChild(stem);

        // Diyez i≈üareti
        if (isSharp) {
          const sharp = document.createElementNS("http://www.w3.org/2000/svg", "text");
          sharp.setAttribute("x", xPos - 18);
          sharp.setAttribute("y", yPos + 5);
          sharp.setAttribute("font-size", "16");
          sharp.setAttribute("fill", "#222");
          sharp.textContent = "‚ôØ";
          notesGroup.appendChild(sharp);
        }

        // Ledger line (C i√ßin)
        if (note === "C" || note === "C#") {
          const ledger = document.createElementNS("http://www.w3.org/2000/svg", "line");
          ledger.setAttribute("x1", xPos - 12);
          ledger.setAttribute("y1", 128);
          ledger.setAttribute("x2", xPos + 12);
          ledger.setAttribute("y2", 128);
          ledger.setAttribute("stroke", "#333");
          ledger.setAttribute("stroke-width", "1");
          notesGroup.appendChild(ledger);
        }

        // Nota ismi (altƒ±nda)
        const noteName = document.createElementNS("http://www.w3.org/2000/svg", "text");
        noteName.setAttribute("x", xPos);
        noteName.setAttribute("y", 170);
        noteName.setAttribute("text-anchor", "middle");
        noteName.setAttribute("font-size", "14");
        noteName.setAttribute("font-family", "JetBrains Mono");
        noteName.setAttribute("fill", "#666");
        noteName.textContent = note;
        notesGroup.appendChild(noteName);
      });

      // Akor ismini ekle
      const chordLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
      chordLabel.setAttribute("x", 150 + (noteNames.length - 1) * 40);
      chordLabel.setAttribute("y", 45);
      chordLabel.setAttribute("text-anchor", "middle");
      chordLabel.setAttribute("font-size", "18");
      chordLabel.setAttribute("font-weight", "bold");
      chordLabel.setAttribute("font-family", "JetBrains Mono");
      chordLabel.setAttribute("fill", "#00aa55");
      chordLabel.textContent = chordName;
      notesGroup.appendChild(chordLabel);
    }

    // === PLAYBACK (√áALMA) Sƒ∞STEMƒ∞ ===

    function startPlayback() {
      if (currentChords.length === 0) return;
      if (isPlaying) return;

      isPlaying = true;
      currentChordIndex = 0;

      updatePlayButton();

      const chordDuration = getChordDuration();

      playbackInterval = setInterval(() => {
        if (currentChordIndex >= currentChords.length) {
          if (isLooping) {
            currentChordIndex = 0;
          } else {
            stopPlayback();
            return;
          }
        }

        const chord = currentChords[currentChordIndex];
        playChord(chord.name, chordDuration / 1000 * 0.9);
        selectChord(currentChordIndex);
        highlightPlayingChord(currentChordIndex);
        updateProgress();

        currentChordIndex++;
      }, chordDuration);

      // ƒ∞lk akoru hemen √ßal
      const firstChord = currentChords[0];
      playChord(firstChord.name, chordDuration / 1000 * 0.9);
      selectChord(0);
      highlightPlayingChord(0);
      currentChordIndex = 1;
    }

    function stopPlayback() {
      isPlaying = false;
      currentChordIndex = 0;

      if (playbackInterval) {
        clearInterval(playbackInterval);
        playbackInterval = null;
      }

      updatePlayButton();
      updateProgress();

      document.querySelectorAll(".chord-chip").forEach(chip => {
        chip.classList.remove("playing");
      });
    }

    function togglePlayback() {
      if (isPlaying) {
        stopPlayback();
      } else {
        if (currentChords.length === 0) {
          generateChordProgression();
        } else {
          startPlayback();
        }
      }
    }

    function toggleLoop() {
      isLooping = !isLooping;
      document.getElementById("loopBtn").classList.toggle("active", isLooping);
    }

    function updatePlayButton() {
      const playBtn = document.getElementById("playBtn");
      if (isPlaying) {
        playBtn.textContent = "‚è∏";
        playBtn.classList.add("playing");
      } else {
        playBtn.textContent = "‚ñ∂";
        playBtn.classList.remove("playing");
      }
    }

    function updateProgress() {
      const progressFill = document.getElementById("progressFill");
      const currentChordNum = document.getElementById("currentChordNum");
      const currentTime = document.getElementById("currentTime");

      if (currentChords.length === 0) {
        progressFill.style.width = "0%";
        currentChordNum.textContent = "Akor 0/0";
        currentTime.textContent = "0:00";
        return;
      }

      const progress = (currentChordIndex / currentChords.length) * 100;
      progressFill.style.width = `${progress}%`;
      currentChordNum.textContent = `Akor ${Math.min(currentChordIndex + 1, currentChords.length)}/${currentChords.length}`;

      // Tahmini s√ºre
      const totalMs = currentChords.length * getChordDuration();
      const currentMs = currentChordIndex * getChordDuration();
      const totalSec = Math.floor(totalMs / 1000);
      const currentSec = Math.floor(currentMs / 1000);
      currentTime.textContent = `${Math.floor(currentSec / 60)}:${(currentSec % 60).toString().padStart(2, "0")} / ${Math.floor(totalSec / 60)}:${(totalSec % 60).toString().padStart(2, "0")}`;
    }

    // === METRONOM ===

    function startMetronome() {
      if (metronomeInterval) return;

      metronomeOn = true;
      currentBeat = 0;
      document.getElementById("metronomeBtn").classList.add("active");

      const beatDuration = getMillisecondsPerBeat();

      metronomeInterval = setInterval(() => {
        playMetronomeClick(currentBeat === 0);
        updateMetronomeVisual(currentBeat);

        currentBeat = (currentBeat + 1) % beatsPerMeasure;
      }, beatDuration);

      // ƒ∞lk vuru≈üu hemen √ßal
      playMetronomeClick(true);
      updateMetronomeVisual(0);
      currentBeat = 1;
    }

    function stopMetronome() {
      metronomeOn = false;
      document.getElementById("metronomeBtn").classList.remove("active");

      if (metronomeInterval) {
        clearInterval(metronomeInterval);
        metronomeInterval = null;
      }

      // G√∂rsel sƒ±fƒ±rla
      document.querySelectorAll(".beat-dot").forEach(dot => {
        dot.classList.remove("active", "accent");
      });
    }

    function toggleMetronome() {
      if (metronomeOn) {
        stopMetronome();
      } else {
        startMetronome();
      }
    }

    function playMetronomeClick(isAccent) {
      if (!audioCtx) initAudio();
      resumeAudio();

      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();

      osc.type = "sine";
      osc.frequency.value = isAccent ? 1000 : 800;

      gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);

      osc.connect(gain);
      gain.connect(masterGain);

      osc.start();
      osc.stop(audioCtx.currentTime + 0.05);
    }

    function updateMetronomeVisual(beat) {
      const dots = document.querySelectorAll(".beat-dot");
      dots.forEach((dot, index) => {
        dot.classList.remove("active", "accent");
        if (index === beat) {
          dot.classList.add("active");
          if (beat === 0) {
            dot.classList.add("accent");
          }
        }
      });
    }

    // Tempo deƒüi≈ütirme
    function changeTempo(delta) {
      tempo = Math.max(40, Math.min(240, tempo + delta));
      document.getElementById("tempoDisplay").textContent = tempo;

      // Metronom √ßalƒ±yorsa yeniden ba≈ülat
      if (metronomeOn) {
        stopMetronome();
        startMetronome();
      }

      // Playback √ßalƒ±yorsa yeniden ba≈ülat
      if (isPlaying) {
        stopPlayback();
        startPlayback();
      }
    }

    // === PRESET'LER ===

    function applyPreset(presetId) {
      const preset = PRESETS[presetId];
      if (!preset) return;

      document.getElementById("keySelect").value = preset.key;
      document.getElementById("scaleSelect").value = preset.scale;

      if (preset.chordType) {
        document.getElementById("chordTypeSelect").value = preset.chordType;
      }

      // Uzunluƒüu preset'e g√∂re ayarla
      const presetLength = preset.degrees.length;
      const lengthSelect = document.getElementById("lengthSelect");
      if (presetLength <= 4) {
        lengthSelect.value = "4";
      } else if (presetLength <= 8) {
        lengthSelect.value = "8";
      } else {
        lengthSelect.value = "12";
      }

      // Akorlarƒ± manuel olu≈ütur
      const scaleChords = buildScaleChords(preset.key, preset.scale, preset.chordType || "triads");

      currentChords = preset.degrees.map(degree => {
        const adjustedDegree = ((degree - 1) % scaleChords.length) + 1;
        return {
          ...scaleChords[adjustedDegree - 1],
          degree: adjustedDegree
        };
      });

      updateChordDisplay();
      updateTags(preset.key, preset.scale, "preset");
      document.getElementById("tagStyle").textContent = preset.name;

      if (currentChords.length > 0) {
        selectChord(0);
      }
    }

    // === ARTƒ∞K√úLASYON SE√áƒ∞Mƒ∞ ===

    function setArticulation(articulation) {
      currentArticulation = articulation;

      document.querySelectorAll(".articulation-btn").forEach(btn => {
        btn.classList.remove("active");
      });

      document.querySelector(`.articulation-btn[data-articulation="${articulation}"]`)?.classList.add("active");
    }

    // === MOD DEƒûƒ∞≈ûTƒ∞RME ===

    function setMode(mode) {
      currentMode = mode;

      document.querySelectorAll(".mode-tab").forEach(tab => {
        tab.classList.remove("active");
      });
      document.querySelector(`.mode-tab[data-mode="${mode}"]`)?.classList.add("active");

      // Panelleri g√∂ster/gizle
      document.getElementById("trainingPanel").style.display = mode === "practice" ? "block" : "none";
      document.getElementById("quizPanel").style.display = mode === "quiz" ? "block" : "none";

      if (mode === "quiz") {
        startQuiz();
      }
    }

    // === ANTRENMAN MODU ===

    function updateTrainingStats() {
      document.getElementById("statCorrect").textContent = quizStats.correct;
      document.getElementById("statTotal").textContent = quizStats.total;
      const accuracy = quizStats.total > 0 ? Math.round((quizStats.correct / quizStats.total) * 100) : 0;
      document.getElementById("statAccuracy").textContent = accuracy + "%";
    }

    // === QUƒ∞Z MODU ===

    function startQuiz() {
      // Rastgele bir akor se√ß
      const allRoots = NOTES_SHARP;
      const allTypes = ["maj", "min", "dim", "aug", "maj7", "min7", "dom7"];

      const randomRoot = pickRandom(allRoots);
      const randomType = pickRandom(allTypes);
      const correctChord = randomRoot + CHORD_TYPES[randomType].symbol;

      quizCorrectAnswer = correctChord;

      // 4 se√ßenek olu≈ütur (1 doƒüru, 3 yanlƒ±≈ü)
      const options = [correctChord];

      while (options.length < 4) {
        const wrongRoot = pickRandom(allRoots);
        const wrongType = pickRandom(allTypes);
        const wrongChord = wrongRoot + CHORD_TYPES[wrongType].symbol;

        if (!options.includes(wrongChord)) {
          options.push(wrongChord);
        }
      }

      // Karƒ±≈ütƒ±r
      const shuffled = shuffleArray(options);

      // UI g√ºncelle
      const quizOptions = document.getElementById("quizOptions");
      quizOptions.innerHTML = "";

      shuffled.forEach(option => {
        const btn = document.createElement("button");
        btn.className = "quiz-option";
        btn.textContent = option;
        btn.addEventListener("click", () => checkQuizAnswer(option, btn));
        quizOptions.appendChild(btn);
      });

      // Akoru √ßal
      playChord(correctChord, 1.2);
      highlightPiano(correctChord);
    }

    function checkQuizAnswer(answer, btnElement) {
      quizStats.total++;

      if (answer === quizCorrectAnswer) {
        quizStats.correct++;
        btnElement.classList.add("correct");
      } else {
        btnElement.classList.add("wrong");
        // Doƒüru cevabƒ± g√∂ster
        document.querySelectorAll(".quiz-option").forEach(btn => {
          if (btn.textContent === quizCorrectAnswer) {
            btn.classList.add("correct");
          }
        });
      }

      updateTrainingStats();

      // 1.5 saniye sonra yeni soru
      setTimeout(() => {
        startQuiz();
      }, 1500);
    }

    function playQuizChordAgain() {
      if (quizCorrectAnswer) {
        playChord(quizCorrectAnswer, 1.2);
      }
    }

    // === SES AYARLARI ===

    function setVolume(value) {
      volume = value / 100;
      if (masterGain) {
        masterGain.gain.value = volume;
      }
      document.getElementById("volumeValue").textContent = value + "%";
    }

    function toggleReverb() {
      reverbEnabled = !reverbEnabled;
      document.getElementById("reverbToggle").classList.toggle("active", reverbEnabled);
    }

    function setOctave(octave) {
      currentOctave = parseInt(octave, 10);
    }

    function setInstrument(instrument) {
      currentInstrument = instrument;
    }

    // === EVENT LISTENERS ===

    document.addEventListener("DOMContentLoaded", () => {
      // Audio context'i kullanƒ±cƒ± etkile≈üimiyle ba≈ülat
      document.body.addEventListener("click", () => {
        if (!audioCtx) initAudio();
      }, { once: true });

      // Generate butonu
      document.getElementById("generateBtn").addEventListener("click", () => {
        stopPlayback();
        generateChordProgression();
      });

      // Transport kontrolleri
      document.getElementById("playBtn").addEventListener("click", togglePlayback);
      document.getElementById("stopBtn").addEventListener("click", stopPlayback);
      document.getElementById("loopBtn").addEventListener("click", toggleLoop);
      document.getElementById("metronomeBtn").addEventListener("click", toggleMetronome);

      // Tempo kontrolleri
      document.getElementById("tempoUp").addEventListener("click", () => changeTempo(5));
      document.getElementById("tempoDown").addEventListener("click", () => changeTempo(-5));

      // Mod sekmeleri
      document.querySelectorAll(".mode-tab").forEach(tab => {
        tab.addEventListener("click", () => {
          setMode(tab.dataset.mode);
        });
      });

      // Artik√ºlasyon butonlarƒ±
      document.querySelectorAll(".articulation-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          setArticulation(btn.dataset.articulation);
        });
      });

      // Preset butonlarƒ±
      document.querySelectorAll(".preset-chip").forEach(chip => {
        chip.addEventListener("click", () => {
          applyPreset(chip.dataset.preset);
        });
      });

      // Ses ayarlarƒ±
      document.getElementById("volumeSlider").addEventListener("input", (e) => {
        setVolume(e.target.value);
      });

      document.getElementById("reverbToggle").addEventListener("click", toggleReverb);

      document.getElementById("octaveSelect").addEventListener("change", (e) => {
        setOctave(e.target.value);
      });

      document.getElementById("instrumentSelect").addEventListener("change", (e) => {
        setInstrument(e.target.value);
      });

      // Quiz tekrar √ßal butonu
      document.getElementById("playQuizChord").addEventListener("click", playQuizChordAgain);

      // Piyano tu≈ülarƒ±na tƒ±klama
      document.querySelectorAll(".piano-key").forEach(key => {
        key.addEventListener("click", () => {
          const note = key.dataset.note;
          const octave = parseInt(key.dataset.octave, 10) || 4;
          const freq = getNoteFrequency(note, octave);
          playNote(freq, 0.5);
        });
      });

      // Klavye kƒ±sayollarƒ±
      document.addEventListener("keydown", (e) => {
        if (e.code === "Space") {
          e.preventDefault();
          togglePlayback();
        } else if (e.code === "KeyM") {
          toggleMetronome();
        } else if (e.code === "KeyL") {
          toggleLoop();
        } else if (e.code === "KeyG") {
          generateChordProgression();
        } else if (e.code === "Escape") {
          stopPlayback();
          stopMetronome();
        } else if (e.code === "ArrowUp") {
          changeTempo(5);
        } else if (e.code === "ArrowDown") {
          changeTempo(-5);
        }
      });

      // ƒ∞lk y√ºklemede progress g√ºncelle
      updateProgress();
    });

    // ============================================
    // B√ñL√úM 3 SONU - KOD TAMAMLANDI
    // ============================================
  </script>
</body>
</html>